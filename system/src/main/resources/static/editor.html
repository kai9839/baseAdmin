<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>OnlyOffice Editor</title>
    <script type="text/javascript" src="http://192.168.28.87:9999/web-apps/apps/api/documents/api.js"></script>
</head>
<body>
    <div id="placeholder"></div>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const fileName = urlParams.get('fileName');
        const fileType = urlParams.get('fileType');
        const key = urlParams.get('key');

        fetch(`/onlyoffice/config?fileName=${fileName}&fileType=${fileType}&key=${key}`)
            .then(response => response.json())
            .then(data => {
                const config = data.data;
                // 添加OnlyOffice服务器地址
                config.editorConfig.customization = {
                    goback: {
                        url: "/",
                    }
                };
                new DocsAPI.DocEditor("placeholder", config);
            });
    </script>
</body>
</html> 